<?xml version="1.0"?>
<robot xmlns:controller="http://playerstage.sourceforge.net/gazebo/xmlschema/#controller"
                        xmlns:interface="http://playerstage.sourceforge.net/gazebo/xmlschema/#interface"
                        xmlns:sensor="http://playerstage.sourceforge.net/gazebo/xmlschema/#sensor"
                        xmlns:xacro="http://playerstage.sourceforge.net/gazebo/xmlschema/#interface"
	 name="two_lwr">

  <include filename="$(find two_lwr_defs)/calibration/default_cal.xml"/>
  <include filename="$(find lwr_defs)/defs/kuka_lwr_arm_defs.xml"/>
  <include filename="$(find lwr_defs)/defs/materials.xml"/>
  <include filename="$(find barret_hand_defs)/defs/barret_hand.urdf.xacro"/>
  <include filename="$(find two_lwr_defs)/defs/kinect_camera.urdf.xacro" />
  <include filename="$(find two_lwr_defs)/defs/head.urdf.xacro" />
  
<link name="world" />

  <joint name="arm_world_joint" type="fixed">
    <origin xyz="0 0 0.77" rpy="0 0 0"/>
    <parent link="world"/>
    <child link="table_link"/>
  </joint>


  <link name="table_link">
    <inertial>
      <mass value="50.0"/>
      <com xyz="0 0 0"/>
      <inertia  ixx="0.01" ixy="0.00"  ixz="0.00"
                iyy="0.01" iyz="0.00"
                izz="0.01" />
    </inertial>

    <visual>
      <origin xyz="0 0 0.0" rpy="0 0 0"/>
      <geometry>
        <box size="0.52 1.8 0.1"/>
      </geometry>
    </visual>

    <collision>
      <origin xyz="0 0 0.0" rpy="0 0 0"/>
      <geometry>
        <box size="0.52 1.8 0.1"/>
      </geometry>
    </collision>
  </link>

  <joint name="torso_joint" type="fixed">
    <origin xyz="0 0 0.82" rpy="0 0 0"/>
    <parent link="world"/>
    <child link="torso_link"/>
  </joint>

  <link name="torso_link">
  </link>

  <kuka_lwr_arm parent="torso" name="left" right="-1">
    <origin xyz="${cal_base_to_left_arm_x} ${cal_base_to_left_arm_y} ${cal_base_to_left_arm_z}"
            rpy="${cal_base_to_left_arm_roll} ${cal_base_to_left_arm_pitch} ${cal_base_to_left_arm_yaw}"/>
  </kuka_lwr_arm>

  <kuka_lwr_arm parent="torso" name="right" right="1">
    <origin xyz="${cal_base_to_right_arm_x} ${cal_base_to_right_arm_y} ${cal_base_to_right_arm_z}"
            rpy="${cal_base_to_right_arm_roll} ${cal_base_to_right_arm_pitch} ${cal_base_to_right_arm_yaw}"/>
  </kuka_lwr_arm>
  
  <joint name="right_cb_joint" type="fixed">
    <origin xyz="-0.051 -0.03 0.009" rpy="-${21.0 * M_PI/180.0} 0 ${0.5 * M_PI}"/>
    <parent link="right_arm_7_link"/>
    <child link="right_cb_link"/>
  </joint>
  
  <link name="right_cb_link">
  </link>
  
  <joint name="left_cb_joint" type="fixed">
    <origin xyz="0.051 0.03 0.009" rpy="-${21.0 * M_PI/180.0} 0 ${0.5 * M_PI}"/>
    <parent link="left_arm_7_link"/>
    <child link="left_cb_link"/>
  </joint>
  
  <link name="left_cb_link">
  </link>
  
  <joint name="right_tool_joint" type="fixed">
    <origin xyz="-0.115 0 -0.055" rpy="0 -${0.5 * M_PI} 0"/>
    <parent link="right_arm_7_link"/>
    <child link="right_tool_link"/>
  </joint>

  <link name="right_tool_link">
  </link>

  <joint name="left_tool_joint" type="fixed">
    <origin xyz="0.115 0 -0.055" rpy="0 -${0.5 * M_PI} ${M_PI}"/>
    <parent link="left_arm_7_link"/>
    <child link="left_tool_link"/>
  </joint>

  <link name="left_tool_link">
  </link>
  
  <joint name="right_finger_joint" type="fixed">
    <origin xyz="0.0 0.03 0.12" rpy="0 0 0"/>
    <parent link="right_tool_link"/>
    <child link="right_finger_link"/>
  </joint>
  
  <link name="right_finger_link">
  </link>
  
  <joint name="left_finger_joint" type="fixed">
    <origin xyz="0.0 0.03 0.12" rpy="0 0 0"/>
    <parent link="left_tool_link"/>
    <child link="left_finger_link"/>
  </joint>
  
  <link name="left_finger_link">
  </link>
  
<!--
  <xacro:barret_hand prefix="right" parent="right_tool_link">
  </xacro:barret_hand>

  <xacro:barret_hand prefix="left" parent="left_tool_link">
  </xacro:barret_hand>
  -->
  
  <gazebo>
    <controller:lwr_controller name="left_lwr_controller" plugin="liblwr_controller.so">
      <alwaysOn>true</alwaysOn>
      <robotPrefix>left</robotPrefix>
      <remotePort>49938</remotePort>
      <baseLink>table_link</baseLink>
      <toolLink>left_tool_link</toolLink>
      <left_arm_0_joint>1.57</left_arm_0_joint>
      <left_arm_1_joint>1.6</left_arm_1_joint>
      <left_arm_2_joint>-1.57</left_arm_2_joint>
      <left_arm_3_joint>-1.57</left_arm_3_joint>
      <left_arm_4_joint>-0.1</left_arm_4_joint>
      <left_arm_5_joint>1.57</left_arm_5_joint>
      <left_arm_6_joint>0.0</left_arm_6_joint>
    </controller:lwr_controller>
  </gazebo>

  
  <gazebo>
    <controller:lwr_controller name="right_lwr_controller" plugin="liblwr_controller.so">
      <alwaysOn>true</alwaysOn>
      <robotPrefix>right</robotPrefix>
      <remotePort>49948</remotePort>
      <baseLink>table_link</baseLink>
      <toolLink>right_tool_link</toolLink>
      <right_arm_0_joint>0.0</right_arm_0_joint>
      <right_arm_1_joint>-1.6</right_arm_1_joint>
      <right_arm_2_joint>1.57</right_arm_2_joint>
      <right_arm_3_joint>1.57</right_arm_3_joint>
      <right_arm_4_joint>0.1</right_arm_4_joint>
      <right_arm_5_joint>-1.57</right_arm_5_joint>
      <right_arm_6_joint>0.0</right_arm_6_joint>
    </controller:lwr_controller>
  </gazebo>

  <velma_head parent="torso_link">
      <origin xyz="0.10 0 0.795" rpy="0 0 0"/>
  </velma_head>


</robot>
